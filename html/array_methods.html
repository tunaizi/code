<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body>
  <script>
    // 数组排列组合
    const log = (...args) => {
      console.log(...args)
    }
    //数组内容排列组合
    function fillflat(arr) {
      if (arr.length <= 2) {
        return [arr[1] + arr[0], arr[0] + arr[1]]
      } else {
        let resultList = []
        for (let i = 0; i < arr.length; i++) {
          let item = arr.splice(i, 1)[0] //取出一个数  a   //b   //c
          let balanceList = fn(arr) //["bc","cb"];  // [a,c]  [a,b]
          for (let j = 0; j < balanceList.length; j++) {
            let item1 = balanceList[j] //bc  cb
            resultList.push(item + item1) //abc  acb
          }
          arr.splice(i, 0, item) //["a","b","c"]
        }
        return resultList
      }
    }
    //数组乱序操作
    const sk = arr => {
      for (let i = 0; i < arr.length; i++) {
        let index = Math.floor(Math.random() * arr.length)
        let mid = arr[i]
        arr[i] = arr[index]
        arr[index] = mid
        index = null
      }
      return arr
    }
    //数组排序
    const srrSort = arrs => {
      for (let i = 0; i < arrs.length; i++) {
        for (let a = i + 1; a < arrs.length; a++) {
          if (arrs[i] > arrs[a]) {
            let mid = arrs[a]
            arrs[a] = arrs[i]
            arrs[i] = mid
          } else {
            continue
          }
        }
      }
      return arrs
    }

    /* ____________________________________________________________________________ */

    //  数组原型增加del方法
    Array.prototype.del = function (index) {
      if (index && !isNaN(index) && index < this.length) {
        let delItem = Symbol("del")
        if (index in this) {
          this[index] = delItem
          for (let i = 0, n = 0; i < this.length; i++) {
            if (this[i] !== delItem && index !== i) {
              this[n++] = this[i]
            }
          }
          this.length--
        }
      }
    }
    //并集
    let arr = [..."ABCDEFG8"]
    let brr = [..."12345678ABC"]
    log(...arr)
    log(...brr)
    //arr 和 brr 的并集 =>
    let union = [...arr, ...brr]
    // log('arr,brr的并集', ...union);
    const intersection = (arr, brr) => {
      //写法1双重循环写法
      let res = []
      for (let i = 0; i < arr.length; i++) {
        for (let k = 0; k < brr.length; k++) {
          if (brr.includes(arr[i])) {
            if (!res.includes(arr[i])) {
              res.push(arr[i])
            }
          }
        }
      }
      return res
    }
    const intersection2 = (arr, brr) => {
      //写法2数组过滤
      let res = []
      res = arr.filter(item => {
        return brr.includes(item)
      })
      return res
    }
    //两个集合中共同存在的元素
    log("arr,brr的交集", intersection(arr, brr))
    log("arr,brr的交集", intersection2(arr, brr))
    // log([...'ABCDEF'].indexOf('A'));
    // 差集两个集合都不存在的元素
    const defference = (arr, brr) => {
      let res = []
      res = arr.filter(item => !brr.includes(item))
      return res
    }
    log("arr,brr的差集", defference(arr, brr))

    const cartesianProduct = (ar, br) => {
      let arr = []
      for (const ite of ar) {
        for (const ele of br) {
          arr.push(`${ite}${ele}`)
        }
      }
      return arr
    }

    function prowerSet(arr) {
      var ps = [[]]
      for (var i = 0; i < arr.length; i++) {
        for (var j = 0, len = ps.length; j < len; j++) {
          log(arr[i], "---------------------")
          log(ps[j], "---------------------")
          ps.push(ps[j].concat(arr[i]))
        }
      }
      return ps
    }
    let alist = ["123", "456", "908", "80"]
    let blist = ["AA", "BB", "123", "908"]

    log("arr,brr迪卡尔积", cartesianProduct(arr, brr))
    log("arr,brr迪卡尔积", cartesianProduct(alist, blist))
    log("arr,brr幂集", prowerSet(alist, blist))
    const toarrobj = {
      1: { val: "1", k: 1 },
      3: { val: "3", k: 3 },
      4: { val: "4", k: 4 },
      5: { val: "5", k: 5 },
      6: { val: "6", k: 6 },
      37: { val: "7", k: 37 },
      19: { val: "7", k: 19 }
    }

    // const arrr = Array.from(
    //   Object.assign(toarrobj, { length: 1 + Math.max(...Object.keys(toarrobj)) }),
    //   function (a, b) {
    //     console.log(a, b, "--", this)
    //     return a ? a : { val: "" }
    //   },
    //   toarrobj
    // )

    // console.log(arrr)
    console.log(Object.values(toarrobj))

    const map = new Map([
      ["foo", "bar"],
      ["baz", 42],
      ["bddaz", 4332]
    ])
    console.log(map)
    // const obj = Object.fromEntries(map)
    const obj = Object.fromEntries([
      ["foo", "bar"],
      ["f1oo", "bar"],
      ["baz", 42],
      ["bddaz", 4332]
    ])

    console.log(obj)
    const arr11 = [1, 2, 3, 2, 6, 2, 2, 1, 2, 3, 4, 5]
    function duplicateRemoval(arr) {
      return Object.values(Object.fromEntries(Array.from(arr, e => [e, e])))
    }
    console.log(duplicateRemoval(arr11))


    let list = [
      { id: 1, name: "部门A", parentId: 0 },
      { id: 2, name: "部门B", parentId: 0 },
      { id: 3, name: "部门C", parentId: 1 },
      { id: 4, name: "部门D", parentId: 1 },
      { id: 5, name: "部门E", parentId: 2 },
      { id: 6, name: "部门F", parentId: 3 },
      { id: 7, name: "部门G", parentId: 2 },
      { id: 8, name: "部门H", parentId: 4 }
    ];
    let result = convert2(list);
    function convert2(array) {
      let res = [];
      let map = array.reduce(
        (prev, curr) => ((prev[curr.id] = curr), prev),
        {}
      );
      // console.log(map, "map");
      for (let item of list) {
        if (item.parentId === 0) {
          res.push(item);
          continue;
        } else if (item.parentId in map) {
          let parent = map[item.parentId];
          parent.children = parent.children || [];
          parent.children.push(item);
        }
      }
      return res;
    }
    console.log(result);
    function convert3(arr, res = []) {
      for (let index = 0; index < arr.length; index++) {
        const { children = [], ...other } = arr[index];
        res.push(other);
        children && children.length && convert3(children, res);
      }
      return res;
    }
    console.log(convert3(result).sort((a, b) => a.id - b.id));
  </script>
</body>

</html>